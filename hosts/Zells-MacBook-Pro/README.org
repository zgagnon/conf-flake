* Default.nix
:PROPERTIES:
:header-args:
:END:

** Base System
#+begin_src nix :tangle default.nix
{ pkgs, lib, ... }:
let
  homebrew = import ./homebrew.nix;
  homeDirectory = "/Users/zell";
  gitmessage = ./.gitmessage;
  email = "zell@mechanical-orchard.com";
  packages = import ./home-manager.nix { inherit pkgs; };
in {
  imports = [
    ../../system
    ../../os/mac
    ../../programs/direnv
    ../../programs/zsh
    ../../programs/vim
    (import ../../programs/paperwm.spoon { inherit homeDirectory lib pkgs; })
    (import ../../programs/homebrew { inherit homebrew; })
    (import ../../programs/git {
      inherit lib gitmessage pkgs homeDirectory email;
    })
  ];

  home-manager = {
    useGlobalPkgs = true;
    useUserPackages = true;
    users.zell = { pkgs, config, ... }: {
      imports = [ ../../programs/1password ];
      home = {
        stateVersion = "23.11";
        username = lib.mkDefault "zell";
        homeDirectory = lib.mkForce homeDirectory;

        sessionVariables = { EDITOR = "vim"; };

        packages = packages;
      };
      programs.home-manager.enable = true;
    };
  };
}
#+end_src

** Homebrew Installs

#+begin_src nix :tangle ./homebrew.nix
{
  brews = [ "exercism" ];

  taps = [ "homebrew/cask-fonts" ];

  casks = [
    "skype"
    "cursor"
    "notion"
    "orbstack"
    "hammerspoon"
    "zoom"
    "font-fira-mono-nerd-font"
    "logseq"
    "raycast"
    "slack"
    "tuple"
    "tandem"
    "warp"
    "arc"
    "readdle-spark"
    "docker"
    "spotify"
    "google-chrome"
    "soundsource"
  ];
}

#+end_src

** Home Manager Installs

#+begin_src nix :tangle ./home-manager.nix
{ pkgs, ... }:
with pkgs; [
  _1password
  action-validator
  cabal-install
  dbeaver
  discord
  elixir
  elixir_ls
  emacs
  erlfmt
  fasd
  fd
  fira-code
  google-cloud-sdk
  gnugrep
  haskellPackages.hoogle
  haskellPackages.lsp
  jetbrains.idea-community
  kubectx
  kubernetes-helm
  mob
  neovim
  nixfmt
  nodejs
  pandoc
  ripgrep
  shellcheck
  shfmt
  terraform
  vscodium
  gh
]

#+end_src
